(function(){var e={6700:function(e,t,s){var o={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":5655,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":5655,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":5044,"./fy.js":5044,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":1793,"./ru.js":1793,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function a(e){var t=n(e);return s(t)}function n(e){if(!s.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}a.keys=function(){return Object.keys(o)},a.resolve=n,e.exports=a,a.id=6700},1558:function(e,t,s){"use strict";var o=s(144),a=s(998),n=s(2928),r=s(1713),m=function(){var e=this,t=e._self._c;return t(a.Z,[t(n.Z,{staticClass:"rooms-list"},[t(r.Z,[t("rooms-list"),e.isShowChat?t("chat-component"):e._e()],1)],1)],1)},i=[],l=s(7893),c=s(266),u=s(2150),d=s(4324),h=function(){var e=this,t=e._self._c;return t(c.Z,{attrs:{cols:"4"}},[t(u.Z,[t(r.Z,[t(c.Z,{attrs:{cols:"5"}},[t(l.Z,{attrs:{disabled:""===e.newRoomName,outlined:"",color:"indigo"},on:{click:function(t){return e.createNewRoom()}}},[t(d.Z,{attrs:{dark:""}},[e._v(" mdi-plus ")]),e._v(" new chat ")],1)],1),t(c.Z,{attrs:{cols:"7"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.$v.newRoomName.$model,expression:"$v.newRoomName.$model"}],staticClass:"input pa-1",attrs:{type:"text",placeholder:"Type new room name"},domProps:{value:e.$v.newRoomName.$model},on:{input:function(t){t.target.composing||e.$set(e.$v.newRoomName,"$model",t.target.value)}}}),e.$v.newRoomName.maxLength?e._e():t("div",{staticClass:"error--text"},[e._v(" Максимальный размер имени комнаты "+e._s(e.validationRules.maxRoomTitleLength)+" ")])])],1),t(r.Z,{staticClass:"d-flex justify-space-between align-center"},[t(c.Z,{attrs:{cols:"3"}},[e._v("Your name")]),t(c.Z,{attrs:{cols:"9"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.$v.username.$model,expression:"$v.username.$model"}],staticClass:"input pa-1",attrs:{type:"text",placeholder:"Type your name"},domProps:{value:e.$v.username.$model},on:{input:function(t){t.target.composing||e.$set(e.$v.username,"$model",t.target.value)}}}),e.$v.username.maxLength?e._e():t("div",{staticClass:"error--text"},[e._v(" Максимальный размер имени "+e._s(e.validationRules.maxUsernameLength)+" ")])])],1),e.rooms?t("room-cards",{attrs:{rooms:e.rooms}}):t(r.Z,[t(c.Z,[t("h2",{staticClass:"d-flex justify-space-between align-center mt-5"},[e._v(" Rooms list empty ")]),t("p",[e._v("Не удалось подключиться к серверу")])])],1)],1)],1)},j=[],g=s(1998),p=s(4886),f=function(){var e=this,t=e._self._c;return t(r.Z,{attrs:{dense:""}},e._l(e.rooms,(function(s,o){return t(c.Z,{key:o,attrs:{cols:"12"}},[t(g.Z,[t(p.EB,{staticClass:"text-h6"},[e._v(" Room: "+e._s(s.name)+" ")]),t(p.Qq,[t("div",[e._v("Last message:")]),t("message-component",{attrs:{message:s.last_message}})],1),t(p.h7,[t(l.Z,{staticClass:"ma-2",attrs:{outlined:"",small:"",color:"indigo"},on:{click:function(t){return e.openChat(s.name)}}},[e._v(" Enter ")])],1)],1)],1)})),1)},v=[],y=function(){var e=this,t=e._self._c;return t(u.Z,{staticClass:"pa-0"},[t("div",[t("div",{staticClass:"user-name"},[e._v(e._s(e.message.sender.username))]),t("div",{staticClass:"msg-time"},[e._v(" "+e._s(e.moment(e.message.created).format("HH:mm:ss DD/MM/YYYY"))+" ")])]),t("div",{staticClass:"mt-2"},[e._v(" "+e._s(e.message.text))])])},w=[],R=s(381),b=s.n(R),_={name:"MessageComponent",props:{message:{type:Object,required:!0}},methods:{moment:b()}},x=_,k=s(1001),$=(0,k.Z)(x,y,w,!1,null,"fefa3ed2",null),Z=$.exports,N=s(629),C={name:"RoomCards",components:{"message-component":Z},props:{rooms:{type:Array,required:!0}},methods:{async openChat(e){await this.fetchRoomName(e),await this.fetchRoomHistory()},...(0,N.nv)(["fetchRoomName","fetchRoomHistory"])}},L=C,z=(0,k.Z)(L,f,v,!1,null,"76dc35aa",null),S=z.exports,O=s(379),H={name:"RoomsList",components:{"room-cards":S},data:()=>({newRoomName:""}),computed:{rooms(){return this.$store.state.rooms},username:{get:function(){return this.$store.state.username},set:async function(e){await this.fetchUserName(e),await this.$store.commit("updateRoomHistory",null),await this.$store.commit("updateRoomName",null)}},validationRules(){return this.$store.state?.settings}},async mounted(){await this.fetchRoomsList(),await this.fetchSettings()},methods:{async createNewRoom(){await this.fetchRoomName(this.newRoomName),await this.$store.commit("updateRoomHistory",null),this.newRoomName=""},...(0,N.nv)(["fetchRoomsList","fetchRoomName","fetchUserName","fetchSettings"])},validations(){return{newRoomName:{required:O.C1,maxLength:(0,O.BS)(this.validationRules?.maxRoomTitleLength)},username:{required:O.C1,maxLength:(0,O.BS)(this.validationRules?.maxUsernameLength)}}}},M=H,T=(0,k.Z)(M,h,j,!1,null,"60809966",null),P=T.exports,U=s(9223),q=function(){var e=this,t=e._self._c;return t(c.Z,{attrs:{cols:"8"}},[t(u.Z,[t("div",{staticClass:"chat-header d-flex justify-space-between align-center"},[t("h4",{staticClass:"pa-3"},[e._v(e._s(e.nameRoom))]),t(l.Z,{staticClass:"ma-2",attrs:{color:"darkblue",icon:"","x-small":""},on:{click:function(t){return e.closeRooms()}}},[t(d.Z,[e._v("mdi-close")])],1)],1),t("div",{staticClass:"chat-messages-wrapper"},[e._l(e.history,(function(s,o){return t("div",{key:o,staticClass:"message mt-4"},[t("message-component",{attrs:{message:s}}),o!==e.history.length-1?t(U.Z,{staticClass:"mt-4"}):e._e()],1)})),t("div",{attrs:{id:"hidden-block"}})],2),t(r.Z,{staticClass:"d-flex align-center mt-3"},[t(c.Z,{attrs:{cols:"10"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.$v.message.$model,expression:"$v.message.$model"}],staticClass:"input pa-1",attrs:{type:"text",placeholder:"Type your message"},domProps:{value:e.$v.message.$model},on:{input:function(t){t.target.composing||e.$set(e.$v.message,"$model",t.target.value)}}})]),t(c.Z,{attrs:{cols:"2"}},[t(l.Z,{staticClass:"ma-2",attrs:{outlined:"",color:"indigo"},on:{click:function(t){return e.sendMessage(e.message)}}},[e._v(" Send ")])],1)],1),e.$v.message.maxLength?e._e():t("div",{staticClass:"error--text"},[e._v(" Сообщение должно быть меньше "+e._s(e.validationRules.maxMessageLength)+" знаков ")])],1)],1)},E=[],W=s(9669),B=s.n(W);let Y=null;var D={async getRooms(){const e=await B().get("https://nane.tada.team/api/rooms");return e.data?.result},async getRoomHistory(e){const t=await B().get(`https://nane.tada.team/api/rooms/${e}/history`);return t.data?.result},async getSettings(){const e=await B().get("https://nane.tada.team/api/settings");return e.data?.result},connectWebsocket(e){Y=new WebSocket(`wss://nane.tada.team/ws?username=${e}`),Y.addEventListener("open",(()=>{console.log("connected to WS!")}))},sendMessageToWebsocket(e){Y.send(JSON.stringify(e))}},A={name:"ChatComponent",components:{"message-component":Z},data:()=>({isShowChat:!1,message:"",ws:null,newRoomName:""}),computed:{history(){return this.$store.state.roomHistory},nameRoom(){return this.$store.state.roomName},username(){return this.$store.state.username},validationRules(){return this.$store.state?.settings}},async mounted(){await this.fetchRoomHistory(),this.scrollToLastMessage(),D.connectWebsocket(this.username)},methods:{moment:b(),async closeRooms(){await this.$store.commit("updateRoomHistory",null),await this.$store.commit("updateRoomName",null)},async sendMessage(e){let t={room:this.nameRoom,text:e};""!==e&&(D.sendMessageToWebsocket(t),this.message="",await this.fetchRoomsList()),await this.fetchRoomHistory()},scrollToLastMessage(){const e=document.getElementById("hidden-block");e.scrollIntoView({block:"end"})},...(0,N.nv)(["fetchRoomsList","fetchRoomHistory"])},validations(){return{message:{maxLength:(0,O.BS)(this.validationRules?.maxMessageLength)}}}},F=A,I=(0,k.Z)(F,q,E,!1,null,"3e20e765",null),J=I.exports,Q={name:"App",components:{"rooms-list":P,"chat-component":J},data:()=>({selectedRoom:null}),computed:{nameRoom(){return this.$store.state.roomName},isShowChat(){return!!this.nameRoom}}},V=Q,G=(0,k.Z)(V,m,i,!1,null,null,null),K=G.exports,X=s(8864);o.ZP.use(X.Z);var ee=new X.Z({});o.ZP.use(N.ZP);var te=new N.ZP.Store({state:{rooms:null,roomHistory:null,roomName:null,username:"Козьма Прутков",settings:{maxMessageLength:50,maxRoomTitleLength:50,maxUsernameLength:50,uptime:0}},mutations:{updateRoomsList(e,t){e.rooms=t},updateRoomHistory(e,t){e.roomHistory=t},updateRoomName(e,t){e.roomName=t},updateUserName(e,t){e.username=t},updateSettings(e,t){e.settings=t}},actions:{async fetchRoomsList({commit:e}){const t=await D.getRooms();e("updateRoomsList",t)},async fetchRoomHistory({commit:e}){const t=await D.getRoomHistory(this.state.roomName);e("updateRoomHistory",t)},fetchRoomName({commit:e},t){e("updateRoomName",t)},fetchUserName({commit:e},t){e("updateUserName",t)},async fetchSettings({commit:e}){const t=await D.getSettings();let s={maxMessageLength:t.max_message_length,maxRoomTitleLength:t.max_room_title_length,maxUsernameLength:t.max_username_length,uptime:t.uptime};e("updateSettings",s)}}}),se=s(8620);o.ZP.use(se.ZP),o.ZP.config.productionTip=!1,new o.ZP({vuetify:ee,store:te,render:e=>e(K)}).$mount("#app")}},t={};function s(o){var a=t[o];if(void 0!==a)return a.exports;var n=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=e,function(){var e=[];s.O=function(t,o,a,n){if(!o){var r=1/0;for(c=0;c<e.length;c++){o=e[c][0],a=e[c][1],n=e[c][2];for(var m=!0,i=0;i<o.length;i++)(!1&n||r>=n)&&Object.keys(s.O).every((function(e){return s.O[e](o[i])}))?o.splice(i--,1):(m=!1,n<r&&(r=n));if(m){e.splice(c--,1);var l=a();void 0!==l&&(t=l)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[o,a,n]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,n,r=o[0],m=o[1],i=o[2],l=0;if(r.some((function(t){return 0!==e[t]}))){for(a in m)s.o(m,a)&&(s.m[a]=m[a]);if(i)var c=i(s)}for(t&&t(o);l<r.length;l++)n=r[l],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(c)},o=self["webpackChunktada_nane_front"]=self["webpackChunktada_nane_front"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=s.O(void 0,[998],(function(){return s(1558)}));o=s.O(o)})();
//# sourceMappingURL=app.70b6de09.js.map